{% extends "base.html" %}
{% block content %}
<style>
  body {
    background: linear-gradient(180deg, #f9f9ff 0%, #eef1ff 100%);
    font-family: "Poppins", "Helvetica Neue", sans-serif;
  }
  .card {
    border-radius: 20px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    background: white;
  }
  .section-title {
    font-weight: 600;
    color: #4e6ef2;
  }
  .table thead {
    background-color: #eef1ff;
  }
</style>

<div class="container py-5">
  <h2 class="text-center mb-5">ðŸ“Š Statistiques du mois en cours</h2>

  <!-- RÃ©sumÃ© global -->
  <div class="card p-4 mb-5">
    <h4 class="section-title mb-3">RÃ©sumÃ© financier</h4>
    <div class="row text-center">
      <div class="col-md-3">
        <h6>Revenu net</h6>
        <p class="fw-bold text-success">{{ "%.2f"|format(net_income) }} $</p>
      </div>
      <div class="col-md-3">
        <h6>DÃ©penses fixes</h6>
        <p class="fw-bold text-danger">{{ "%.2f"|format(total_fixed) }} $</p>
      </div>
      <div class="col-md-3">
        <h6>DÃ©penses variables</h6>
        <p class="fw-bold text-danger">{{ "%.2f"|format(total_variable) }} $</p>
      </div>
      <div class="col-md-3">
        <h6>Reste disponible</h6>
        <p class="fw-bold {% if remaining < 0 %}text-danger{% else %}text-success{% endif %}">
          {{ "%.2f"|format(remaining) }} $
        </p>
      </div>
    </div>
  </div>

  <!-- DÃ©penses fixes -->
  <div class="card p-4 mb-5">
    <h4 class="section-title mb-3">ðŸ’¼ DÃ©penses rÃ©currentes</h4>
    {% if fixed_expenses %}
      <table class="table table-hover align-middle">
        <thead>
          <tr><th>CatÃ©gorie</th><th>Total ($)</th></tr>
        </thead>
        <tbody>
          {% for row in fixed_expenses %}
          <tr>
            <td>{{ row["category"] }}</td>
            <td>{{ "%.2f"|format(row["total"]) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="text-muted text-center">Aucune dÃ©pense rÃ©currente enregistrÃ©e.</p>
    {% endif %}
  </div>

  <!-- DÃ©penses variables -->
  <div class="card p-4 mb-5">
    <h4 class="section-title mb-3">ðŸ’¸ DÃ©penses ponctuelles du mois</h4>
    {% if variable_expenses %}
      <table class="table table-striped align-middle">
        <thead>
          <tr><th>CatÃ©gorie</th><th>Ta part ($)</th><th>Total brut ($)</th></tr>
        </thead>
        <tbody>
          {% for row in variable_expenses %}
          <tr>
            <td>{{ row["category"] }}</td>
            <td>{{ "%.2f"|format(row["total"]) }}</td>
            <td>{{ "%.2f"|format(row["total_brut"]) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="text-muted text-center">Aucune dÃ©pense ponctuelle enregistrÃ©e pour ce mois.</p>
    {% endif %}
  </div>

  <!-- Objectif d'Ã©pargne -->
  {% if savings_goal %}
  <div class="card p-4">
    <h4 class="section-title mb-3">ðŸŽ¯ Objectif dâ€™Ã©pargne</h4>
    <p>Montant prÃ©vu : <strong>{{ "%.2f"|format(savings_goal) }} $</strong></p>
    <p>Montant restant Ã  Ã©pargner ce mois-ci :
      <strong class="{% if remaining < 0 %}text-danger{% else %}text-success{% endif %}">
        {{ "%.2f"|format(remaining if remaining > 0 else 0) }} $
      </strong>
    </p>
  </div>
  {% endif %}
</div>
{% endblock %}
